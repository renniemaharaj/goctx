{
  "estimated_tokens": 18000,
  "project_tree": ".\ninternal\n  ‚îî‚îÄ‚îÄ ui\n    ‚îî‚îÄ‚îÄ ui.go\n",
  "files": {
    "internal/ui/ui.go": "package ui\n\nimport (\n\t\"encoding/json\"\n\t\"goctx/internal/apply\"\n\t\"goctx/internal/builder\"\n\t\"github.com/gotk3/gotk3/gdk\"\n\t\"github.com/gotk3/gotk3/gtk\"\n\t\"github.com/gotk3/gotk3/glib\"\n\t\"github.com/webview/webview_go\"\n\t\"os\"\n\t\"path/filepath\"\n)\n\nfunc Run() {\n\tgtk.Init(nil)\n\tapplyCSS()\n\n\twin, _ := gtk.WindowNew(gtk.WINDOW_TOPLEVEL)\n\twin.SetTitle(\"‚óè GoCtx Hybrid Orchestrator\")\n\twin.SetDefaultSize(1400, 1000)\n\n\thbox, _ := gtk.BoxNew(gtk.ORIENTATION_HORIZONTAL, 0)\n\n\t// --- SIDEBAR ---\n\tsidebar := createSidebar()\n\thbox.PackStart(sidebar, false, false, 0)\n\n\t// --- MAIN STACK ---\n\tmainStack, _ := gtk.BoxNew(gtk.ORIENTATION_VERTICAL, 10)\n\tmainStack.SetMarginStart(15)\n\tmainStack.SetMarginEnd(15)\n\n\tlabel(mainStack, \"PROJECT CONTEXT (Read-Only Optimized)\")\n\tsw, _ := gtk.ScrolledWindowNew(nil, nil)\n\ttv, _ := gtk.TextViewNew()\n\ttv.SetMonospace(true)\n\ttv.SetEditable(false) // No CPU waste on cursor/input tracking\n\ttv.SetWrapMode(gtk.WRAP_NONE) // Wrap kills performance on large lines\n\tbuf, _ := tv.GetBuffer()\n\tsw.SetSizeRequest(-1, 200)\n\tsw.Add(tv)\n\tmainStack.PackStart(sw, false, false, 0)\n\n\tbtnBox, _ := gtk.BoxNew(gtk.ORIENTATION_HORIZONTAL, 10)\n\tbtnBuild := newBtn(\"Build Context\")\n\tbtnCopy := newBtn(\"üìã Copy\")\n\tbtnChat := newBtn(\"üåê Open AI Chat\")\n\tbtnBox.PackStart(btnBuild, true, true, 0)\n\tbtnBox.PackStart(btnCopy, true, true, 0)\n\tbtnBox.PackStart(btnChat, true, true, 0)\n\tmainStack.PackStart(btnBox, false, false, 5)\n\n\t// Logic\n\tbtnBuild.Connect(\"clicked\", func() {\n\t\tbuf.SetText(\"// Indexing files...\")\n\t\tgo func() {\n\t\t\tout, _ := builder.BuildSelectiveContext(\".\", nil)\n\t\t\tjs, _ := json.MarshalIndent(out, \"\", \"  \")\n\t\t\tfinalStr := string(js)\n\t\t\tglib.IdleAdd(func() {\n\t\t\t\tbuf.SetText(finalStr)\n\t\t\t})\n\t\t}()\n\t})\n\n\tbtnChat.Connect(\"clicked\", func() {\n\t\t// Launching a separate webview window to keep the main GUI fluid\n\t\tgo func() {\n\t\t\tw := webview.New(false)\n\t\t\tdefer w.Destroy()\n\t\t\tw.SetTitle(\"AI Studio / Claude / ChatGPT\")\n\t\t\tw.SetSize(1200, 900, webview.HintNone)\n\t\t\tw.Navigate(\"https://aistudio.google.com\")\n\t\t\tw.Run()\n\t\t}()\n\t})\n\n\tbtnCopy.Connect(\"clicked\", func() {\n\t\tstart, end := buf.GetBounds()\n\t\ttext, _ := buf.GetText(start, end, false)\n\t\tclipboard, _ := gtk.ClipboardGet(gdk.SELECTION_CLIPBOARD)\n\t\tclipboard.SetText(text)\n\t})\n\n\thbox.PackStart(mainStack, true, true, 0)\n\twin.Add(hbox)\n\twin.ShowAll()\n\tgtk.Main()\n}\n\nfunc createSidebar() *gtk.Box {\n\tsidebar, _ := gtk.BoxNew(gtk.ORIENTATION_VERTICAL, 0)\n\tsidebar.SetSizeRequest(250, -1)\n\tlabel(sidebar, \"STASHES\")\n\tlist, _ := gtk.ListBoxNew()\n\tsidebar.PackStart(list, true, true, 0)\n\treturn sidebar\n}\n\nfunc newBtn(l string) *gtk.Button { b, _ := gtk.ButtonNewWithLabel(l); return b }\nfunc label(box *gtk.Box, t string) { l, _ := gtk.LabelNew(t); l.SetXAlign(0); box.PackStart(l, false, false, 5) }\nfunc applyCSS() {\n\tprovider, _ := gtk.CssProviderNew()\n\tprovider.LoadFromPath(\"assets/style.css\")\n\tscreen, _ := gdk.ScreenGetDefault()\n\tgtk.AddProviderForScreen(screen, provider, gtk.STYLE_PROVIDER_PRIORITY_APPLICATION)\n}\n"
  }
}